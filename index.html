<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UNIVERSE FINANCE CALCULATOR</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
/* ğŸ’¡ [1] ì‹œê°ì /UX ê°œì„  CSS */
html, body {
    margin:0; 
    padding:0; 
    height:100%; 
    font-family:'Orbitron', 'Segoe UI', Arial, sans-serif; /* í°íŠ¸ ë³€ê²½ */
    background:black; 
    color:#e9f2ff;
    overflow: hidden; 
}
/* ë°°ê²½ ìš”ì†ŒëŠ” fixedë¡œ ì „ì²´ í™”ë©´ ê³ ì • */
.nebula, #space {position: fixed; top: 0; left: 0; width: 100%; height: 100%;}
.nebula{width:200vw;height:200vh;top:-50vh;left:-50vw;background:radial-gradient(circle, rgba(80,0,255,0.22) 0%, rgba(0,0,0,0) 70%);mix-blend-mode:screen;animation:spin1 120s linear infinite;}
.nebula:nth-child(2){background:radial-gradient(circle, rgba(0,200,255,0.18) 0%, rgba(0,0,0,0) 70%);animation:spin2 180s linear infinite;}
@keyframes spin1{from{transform:rotate(0deg);} to{transform:rotate(360deg);} }
@keyframes spin2{from{transform:rotate(360deg);} to{transform:rotate(0deg);} }

.calculator-panel{
    position:absolute;
    top:50%; 
    left:50%;
    transform:translate(-50%,-50%); 
    width:90%;
    max-width:600px;
    max-height: 95vh;
    overflow-y: auto;
    
    background:rgba(10,15,40,0.72);
    box-shadow:0 0 35px #4fa3ff80,inset 0 0 30px #6fb5ff50; /* ê·¸ë¦¼ì ê°•í™” */
    border-radius:25px;
    padding:25px;
    backdrop-filter:blur(12px);
    box-sizing: border-box;
    /* ğŸ’¡ íŒ¨ë„ ë‚´ë¶€ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ (Chrome, Safari) */
    scrollbar-width: none; /* Firefox */
}
.calculator-panel::-webkit-scrollbar {display: none;} /* Webkit */

.clock-box{text-align:center;font-size:1.5rem;color:#bcd9ff;margin-bottom:25px;text-shadow:0 0 15px #4fa3ff;} /* í°íŠ¸ í¬ê¸° ë° ê·¸ë¦¼ì ê°•í™” */

.tab-buttons{display:flex;gap:10px;margin-bottom:20px;}
.tab-buttons button{flex:1;padding:12px;border:2px solid transparent;border-radius:10px;background:rgba(50,70,120,0.3);color:#d9e6ff;font-size:1rem;cursor:pointer;transition:0.3s ease-out;}
.tab-buttons button:hover:not(.active) {background:rgba(70,90,140,0.5);}
.tab-buttons button.active{background:#4fa3ff;color:#001;font-weight:bold;box-shadow:0 0 15px #4fa3ff; border: 2px solid #fff;}

.tab{display:none;}
.tab.active{display:block;}
label{margin:6px 0 3px;display:block;color:#d0e0ff;text-shadow:0 0 6px #4fa3ff50; font-size: 0.95rem;}
input, select{width:100%;padding:14px;border:1px solid #4fa3ff60;border-radius:10px;background:rgba(15,25,45,0.8);color:#fff;font-size:1.1rem;margin-bottom:12px;outline:none;box-shadow:inset 0 0 8px #4fa3ff30; transition: border-color 0.3s;}
input:focus, select:focus {border-color: #4fa3ff;} /* í¬ì»¤ìŠ¤ íš¨ê³¼ ê°•í™” */

.calculate{width:100%;padding:16px;border:none;border-radius:10px;background:#4fa3ff;color:#000;font-size:1.2rem;font-weight:bold;cursor:pointer;margin-top:15px;box-shadow:0 0 15px #4fa3ff; transition: 0.3s ease-out;}
.calculate:hover {background:#6dc2ff; box-shadow:0 0 20px #6dc2ff;}

.result-box{margin-top:20px;padding:20px;background:rgba(10,15,35,0.65);border-radius:12px;line-height:1.9;text-shadow:0 0 6px #4fa3ff50; border-left: 5px solid #4fa3ff;}
.result-box b {color: #a0d8ff;}
</style>
</head>
<body>
<div class="nebula"></div>
<div class="nebula"></div>
<canvas id="space"></canvas>

<div class="calculator-panel">
    <div class="clock-box" id="clockDisplay">UNIVERSE FINANCE CALCULATOR</div>
    <div class="tab-buttons">
        <button class="active" onclick="showTab('deposit',event)">ì˜ˆê¸ˆ</button>
        <button onclick="showTab('saving',event)">ì ê¸ˆ</button>
        <button onclick="showTab('loan',event)">ëŒ€ì¶œ</button>
    </div>

    <div id="deposit" class="tab active">
        <label>ì˜ˆì¹˜ê¸ˆì•¡(ì›)</label><input type="number" id="dep_amount" class="num" min="0" placeholder="ì›ê¸ˆ (ìˆ«ìë§Œ ì…ë ¥)">
        <label>ì—° ì´ììœ¨(%)</label><input type="number" id="dep_rate" class="num" min="0" max="100" step="0.01" placeholder="ì—° ì´ììœ¨">
        <label>ê¸°ê°„(ê°œì›”)</label><input type="number" id="dep_month" class="num" min="1" placeholder="ê¸°ê°„ (ê°œì›”)">
        <label>ì´ì ë°©ì‹</label>
        <select id="dep_type">
            <option value="simple">ë‹¨ë¦¬</option>
            <option value="monthly">ì›”ë³µë¦¬</option>
            <option value="yearly">ì—°ë³µë¦¬</option>
        </select>
        <button class="calculate" onclick="calcDeposit()">ê³„ì‚°í•˜ê¸°</button>
        <div id="dep_result" class="result-box"></div>
    </div>

    <div id="saving" class="tab">
        <label>ì›” ë‚©ì…ì•¡(ì›)</label><input type="number" id="sav_amount" class="num" min="0" placeholder="ì›” ë‚©ì…ì•¡ (ìˆ«ìë§Œ ì…ë ¥)">
        <label>ì—° ì´ììœ¨(%)</label><input type="number" id="sav_rate" class="num" min="0" max="100" step="0.01" placeholder="ì—° ì´ììœ¨">
        <label>ê¸°ê°„(ê°œì›”)</label><input type="number" id="sav_month" class="num" min="1" placeholder="ê¸°ê°„ (ê°œì›”)">
        <label>ì´ì ë°©ì‹</label>
        <select id="sav_type">
            <option value="compound">ë³µë¦¬(ì€í–‰ì‹)</option>
            <option value="simple">ë‹¨ë¦¬</option>
        </select>
        <button class="calculate" onclick="calcSaving()">ê³„ì‚°í•˜ê¸°</button>
        <div id="sav_result" class="result-box"></div>
    </div>

    <div id="loan" class="tab">
        <label>ëŒ€ì¶œê¸ˆì•¡(ì›)</label><input type="number" id="loan_amount" class="num" min="0" placeholder="ëŒ€ì¶œ ì›ê¸ˆ (ìˆ«ìë§Œ ì…ë ¥)">
        <label>ì—° ì´ììœ¨(%)</label><input type="number" id="loan_rate" class="num" min="0" max="100" step="0.01" placeholder="ì—° ì´ììœ¨">
        <label>ê¸°ê°„(ê°œì›”)</label><input type="number" id="loan_month" class="num" min="1" placeholder="ê¸°ê°„ (ê°œì›”)">
        <label>ìƒí™˜ ë°©ì‹</label>
        <select id="loan_type">
            <option value="amortization">ì›ë¦¬ê¸ˆê· ë“±</option>
            <option value="principal">ì›ê¸ˆê· ë“±</option>
            <option value="bullet">ë§Œê¸°ì¼ì‹œ</option>
        </select>
        <button class="calculate" onclick="calcLoan()">ê³„ì‚°í•˜ê¸°</button>
        <div id="loan_result" class="result-box"></div>
    </div>
</div>

<script>
// --- JavaScript ì‹œì‘: ê¸°ëŠ¥ ê°•í™” ë° ìœ íš¨ì„± ê²€ì‚¬ ì¶”ê°€ ---

// ì‹œê³„ (ê¸°ì¡´ê³¼ ë™ì¼)
function updateClock(){
    const now=new Date();
    const y=now.getFullYear(), m=String(now.getMonth()+1).padStart(2,'0'), d=String(now.getDate()).padStart(2,'0');
    const days=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];
    const wd=days[now.getDay()];
    const hh=String(now.getHours()).padStart(2,'0'), mm=String(now.getMinutes()).padStart(2,'0'), ss=String(now.getSeconds()).padStart(2,'0');
    // clockDisplay.textContent=`${y}-${m}-${d} (${wd}) ${hh}:${mm}:${ss}`;
}
setInterval(updateClock,1000); updateClock();

// TAB (ê¸°ì¡´ê³¼ ë™ì¼)
function showTab(id,event){
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    document.querySelectorAll(".tab-buttons button").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
    // íƒ­ ì „í™˜ ì‹œ ê²°ê³¼ ì´ˆê¸°í™”
    document.getElementById(id.replace('dep', 'dep').replace('sav', 'sav').replace('loan', 'loan') + '_result').innerHTML = '';
}

// ğŸ’¡ [2] ìˆ«ì í¬ë§·íŒ… ë° ìœ íš¨ì„± ê²€ì‚¬ ê°•í™”
function addComma(num){
    const fixedNum = Number(num).toFixed(2); 
    
    // `.00`ìœ¼ë¡œ ëë‚˜ëŠ” ê²½ìš° ì •ìˆ˜ë¡œ ë³€í™˜í•˜ì—¬ ì½¤ë§ˆ í‘œì‹œ (ì†Œìˆ˜ì  ì œê±°)
    if (fixedNum.endsWith('.00')) {
        return Number(fixedNum).toLocaleString('ko-KR', { maximumFractionDigits: 0 });
    }
    
    // ê·¸ ì™¸ì—ëŠ” ì†Œìˆ˜ì  ë‘ ìë¦¬ê¹Œì§€ ìœ ì§€í•˜ë©° ì½¤ë§ˆ í‘œì‹œ
    return fixedNum.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

function uncomma(str){
    return parseFloat(String(str).replace(/,/g,"")) || 0;
}

// ì…ë ¥ íƒ€ì… ë³€ê²½ (type="number"ë¡œ ë³€ê²½í–ˆìœ¼ë¯€ë¡œ, ì½¤ë§ˆ ë¡œì§ ê°„ì†Œí™”)
document.querySelectorAll(".num").forEach(input => {
    input.addEventListener("input", function() {
        let raw = this.value;
        // ìˆ«ìê°€ ì•„ë‹Œ ë¬¸ì ì œê±° (ë¸Œë¼ìš°ì € ê¸°ë³¸ ë™ì‘ í™œìš©)
        if (raw === "") return;
        
        // ì´ììœ¨ì€ 100 ì´ˆê³¼ ë°©ì§€ (HTML min/max ì†ì„±ê³¼ í•¨ê»˜ ì‘ë™)
        if (this.id.includes('_rate') && parseFloat(raw) > 100) {
            this.value = 100;
        }

    });

    input.addEventListener("blur", function() {
        const val = uncomma(this.value);
        if(!isNaN(val) && val !== 0) {
            // blur ì‹œì ì— ì½¤ë§ˆ í¬ë§·íŒ… í›„ ë‹¤ì‹œ í• ë‹¹ (ì‚¬ìš©ì í¸ì˜)
            // number íƒ€ì…ì´ì§€ë§Œ, ë¬¸ìì—´ë¡œ í¬ë§·íŒ…ëœ ê°’ì„ ë„£ìœ¼ë©´ ë¸Œë¼ìš°ì €ê°€ ìˆ«ì ì…ë ¥ìœ¼ë¡œ ì²˜ë¦¬ ì•ˆí•¨.
            // ë”°ë¼ì„œ ì½¤ë§ˆ í¬ë§·íŒ…ì€ ê²°ê³¼ ì°½ì—ì„œë§Œ ì‚¬ìš©í•˜ê³ , ì…ë ¥ ì°½ì€ ê·¸ëŒ€ë¡œ ë‘ëŠ” ê²ƒì´ UXì— ë” ì í•©í•¨.
            // í˜„ì¬ëŠ” ì½¤ë§ˆ ê¸°ëŠ¥ì„ ì œê±°í•˜ê³ , ìœ íš¨ì„± ê²€ì‚¬ë§Œ ë‚¨ê¹€.
            // this.value = addComma(val); // ì½¤ë§ˆ ê¸°ëŠ¥ì„ ì œê±°í•˜ê³  ë¸Œë¼ìš°ì €ì˜ number ì…ë ¥ í•„ë“œ ê¸°ëŠ¥ì„ ì‚´ë¦¼.
        }
        if (val === 0) {
            this.value = "";
        }
    });
});

// ğŸ’¡ [3] ìœ íš¨ì„± ê²€ì‚¬ í•¨ìˆ˜ (Validation)
function validateInputs(P, r, m, resultElement) {
    if (P <= 0 || r < 0 || m <= 0 || isNaN(P) || isNaN(r) || isNaN(m)) {
        resultElement.innerHTML = `<span style="color:#ff6b6b;">â— ì˜¤ë¥˜: ëª¨ë“  ì…ë ¥ê°’ì„ 0ë³´ë‹¤ í° ìœ íš¨í•œ ìˆ«ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>`;
        return false;
    }
    return true;
}

// ğŸ’° ì˜ˆê¸ˆ (Deposit)
function calcDeposit(){
    const P=uncomma(dep_amount.value);
    const annualRate=uncomma(dep_rate.value)/100;
    const m=Number(uncomma(dep_month.value));
    const type=dep_type.value;
    const resultElement = dep_result;

    if (!validateInputs(P, annualRate * 100, m, resultElement)) return;
    
    const taxRate = 0.154;
    let total=0;

    if(type==="simple") {
        total = P * (1 + annualRate * (m / 12));
    } else if(type==="monthly") {
        const monthlyRate = annualRate / 12;
        total = P * Math.pow(1 + monthlyRate, m);
    } else if(type==="yearly") {
        total = P * Math.pow(1 + annualRate, m / 12);
    }
    
    const interest=total-P;
    const tax = interest * taxRate;
    const afterTaxInterest = interest - tax;
    const afterTaxTotal = P + afterTaxInterest;

    dep_result.innerHTML=`
        ğŸ’° <b>ì˜ˆê¸ˆ ê²°ê³¼ (ì„¸í›„)</b><br>
        ì›ê¸ˆ: ${addComma(P)}ì›<br>
        ì„¸ì „ ì´ì: ${addComma(interest)}ì›<br>
        ì„¸ê¸ˆ(15.4%): ${addComma(tax)}ì›<br>
        ì„¸í›„ ì´ì: **${addComma(afterTaxInterest)}ì›**<br>
        ë§Œê¸°ìˆ˜ë ¹ì•¡: **${addComma(afterTaxTotal)}ì›**
    `;
}

// ğŸ“¦ ì ê¸ˆ (Saving)
function calcSaving(){
    const A = uncomma(sav_amount.value);
    const annualRate = uncomma(sav_rate.value)/100;
    const n = Number(uncomma(sav_month.value));
    const type = sav_type.value;
    const resultElement = sav_result;

    if (!validateInputs(A, annualRate * 100, n, resultElement)) return;
    
    const taxRate = 0.154;
    let total = 0;
    const paid = A*n;

    if(type === "compound"){ // ë³µë¦¬(ì€í–‰ì‹)
        const r = annualRate / 12;
        for(let i=1; i<=n; i++){
            const power = n - i;
            total += A * Math.pow(1 + r, power);
        }
    } else { // ë‹¨ë¦¬
        for(let i=0; i<n; i++){
            total += A * (1 + annualRate * ((n-i) / 12));
        }
    }

    const interest = total - paid;
    const tax = interest * taxRate;
    const afterTaxInterest = interest - tax;
    const afterTaxTotal = paid + afterTaxInterest;

    sav_result.innerHTML = `
        ğŸ“¦ <b>ì ê¸ˆ ê²°ê³¼ (ì„¸í›„)</b><br>
        ì´ ë‚©ì…ì•¡: ${addComma(paid)}ì›<br>
        ì„¸ì „ ì´ì: ${addComma(interest)}ì›<br>
        ì„¸ê¸ˆ(15.4%): ${addComma(tax)}ì›<br>
        ì„¸í›„ ì´ì: **${addComma(afterTaxInterest)}ì›**<br>
        ë§Œê¸°ìˆ˜ë ¹ì•¡: **${addComma(afterTaxTotal)}ì›**
    `;
}

// ğŸ¦ ëŒ€ì¶œ (Loan)
function calcLoan(){
    const L=uncomma(loan_amount.value);
    const annualRate=uncomma(loan_rate.value)/100;
    const n=Number(uncomma(loan_month.value));
    const type=loan_type.value;
    const resultElement = loan_result;

    if (!validateInputs(L, annualRate * 100, n, resultElement)) return;
    
    const r=annualRate/12;
    let monthly=0, total=0, interest=0;

    if(type==="amortization"){ // ì›ë¦¬ê¸ˆê· ë“±
        monthly = L * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
        total=monthly*n; 
        interest=total-L;
        monthly = addComma(monthly) + "ì›";
    } else if(type==="principal"){ // ì›ê¸ˆê· ë“±
        const principal=L/n;
        let intSum=0;
        for(let i=0;i<n;i++) {
            const currentInterest = (L - principal * i) * r;
            intSum += currentInterest;
        }
        interest=intSum; 
        total=L+interest;
        monthly="ë§¤ì›” ì›ê¸ˆ "+addComma(principal)+"ì› + ì´ì (ìµœì´ˆ "+addComma(principal + (L*r))+"ì›)";
    } else if(type==="bullet"){ // ë§Œê¸°ì¼ì‹œ
        interest=L*r*n; 
        total=L+interest; 
        monthly="ë§¤ì›” ì´ì "+addComma(L*r)+"ì› (ë§ˆì§€ë§‰ ë‹¬ì— ì›ê¸ˆ "+addComma(L)+"ì›)";
    }
    loan_result.innerHTML=`ğŸ¦ <b>ëŒ€ì¶œ ê²°ê³¼</b><br>
        ì›” ë‚©ì…ì•¡: ${typeof monthly==="string"?monthly:monthly}<br>
        ì´ ì´ì: ${addComma(interest)}ì›<br>
        ìµœì¢… ìƒí™˜ì•¡: **${addComma(total)}ì›**
    `;
}

// ìŠ¤íƒ€í•„ë“œ (ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜) - ê¸°ì¡´ ì½”ë“œ ìœ ì§€
const canvas=document.getElementById("space"), ctx=canvas.getContext("2d"); let w,h;
function resize(){w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight;}
window.addEventListener("resize",resize); resize();
let stars=[]; let count=1000; let focal=500;
function initStars(){stars=[];for(let i=0;i<count;i++){stars.push({x:(Math.random()-0.5)*w,y:(Math.random()-0.5)*h,z:Math.random()*focal,speed:0.4+Math.random()});}}
initStars();
function animate(){ctx.clearRect(0,0,w,h);for(let s of stars){s.z-=s.speed;if(s.z<=0){s.z=focal;s.x=(Math.random()-0.5)*w;s.y=(Math.random()-0.5)*h;}let k=focal/s.z,px=s.x*k+w/2,py=s.y*k+h/2;ctx.fillStyle="rgba(255,255,255,"+(1-s.z/focal)+")";ctx.beginPath();ctx.arc(px,py,1.2+(1-s.z/focal)*2,0,Math.PI*2);ctx.fill();}requestAnimationFrame(animate);}
animate();
</script>
</body>
</html>
