<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UNIVERSE FINANCE CALCULATOR</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
<style>
/* ğŸ’¡ [1] CSS í°íŠ¸ ìˆ˜ì • ë° ê°€ë…ì„± ê°œì„  */
html, body {
    margin:0; 
    padding:0; 
    height:100%; 
    font-family:'Noto Sans KR', 'Segoe UI', Arial, sans-serif; /* ê¸°ë³¸ í°íŠ¸ Noto Sans KRë¡œ ë³€ê²½ */
    background:black; 
    color:#e9f2ff;
    overflow: hidden; 
}

/* ë°°ê²½ ìš”ì†ŒëŠ” fixedë¡œ ì „ì²´ í™”ë©´ ê³ ì • */
.nebula, #space {position: fixed; top: 0; left: 0; width: 100%; height: 100%;}
.nebula{width:200vw;height:200vh;top:-50vh;left:-50vw;background:radial-gradient(circle, rgba(80,0,255,0.22) 0%, rgba(0,0,0,0) 70%);mix-blend-mode:screen;animation:spin1 120s linear infinite;}
.nebula:nth-child(2){background:radial-gradient(circle, rgba(0,200,255,0.18) 0%, rgba(0,0,0,0) 70%);animation:spin2 180s linear infinite;}
@keyframes spin1{from{transform:rotate(0deg);} to{transform:rotate(360deg);} }
@keyframes spin2{from{transform:rotate(360deg);} to{transform:rotate(0deg);} }

/* ê³„ì‚°ê¸° íŒ¨ë„: ì¤‘ì•™ ê³ ì • ë° ë‚´ë¶€ ìŠ¤í¬ë¡¤ í—ˆìš© */
.calculator-panel{
    position:absolute;
    top:50%; 
    left:50%;
    transform:translate(-50%,-50%);
    width:90%;
    max-width:600px;
    max-height: 98vh; 
    overflow-y: auto; 
    
    background:rgba(10,15,40,0.72);
    box-shadow:0 0 35px #4fa3ff80,inset 0 0 30px #6fb5ff50;
    border-radius:25px;
    padding:25px;
    backdrop-filter:blur(12px);
    box-sizing: border-box;
    scrollbar-width: none; 
}
.calculator-panel::-webkit-scrollbar {display: none;}

.clock-box{
    text-align:center;
    font-size:1.5rem;
    color:#bcd9ff;
    margin-bottom:25px;
    text-shadow:0 0 15px #4fa3ff;
    font-family:'Orbitron', sans-serif; /* ì œëª©ì€ Orbitron ìœ ì§€ */
}

.tab-buttons{display:flex;gap:10px;margin-bottom:20px;}
.tab-buttons button{flex:1;padding:12px;border:2px solid transparent;border-radius:10px;background:rgba(50,70,120,0.3);color:#d9e6ff;font-size:1rem;cursor:pointer;transition:0.3s ease-out;}
.tab-buttons button:hover:not(.active) {background:rgba(70,90,140,0.5);}
.tab-buttons button.active{background:#4fa3ff;color:#001;font-weight:bold;box-shadow:0 0 15px #4fa3ff; border: 2px solid #fff;}

.tab{display:none;}
.tab.active{display:block;}
label{margin:6px 0 3px;display:block;color:#d0e0ff;text-shadow:0 0 6px #4fa3ff50; font-size: 0.95rem;}

input, select{
    width:100%;
    padding:14px;
    border:1px solid #4fa3ff60;
    border-radius:10px;
    background:rgba(15,25,45,0.8);
    color:#fff;
    font-size:1.1rem;
    margin-bottom:12px;
    outline:none;
    box-shadow:inset 0 0 8px #4fa3ff30; 
    transition: border-color 0.3s;
    height: auto; 
    box-sizing: border-box; 
}
input:focus, select:focus {border-color: #4fa3ff;}

.calculate{width:100%;padding:16px;border:none;border-radius:10px;background:#4fa3ff;color:#000;font-size:1.2rem;font-weight:bold;cursor:pointer;margin-top:15px;box-shadow:0 0 15px #4fa3ff; transition: 0.3s ease-out;}
.calculate:hover {background:#6dc2ff; box-shadow:0 0 20px #6dc2ff;}

.result-box{
    /* ğŸ’¡ [ìˆ˜ì •] ê¸°ë³¸ íŒ¨ë”©/ë§ˆì§„/ë³´ë” ì ìš© */
    margin-top:20px;
    padding:20px;
    background:rgba(10,15,35,0.65);
    border-radius:12px;
    line-height:1.9;
    text-shadow:0 0 6px #4fa3ff50; 
    border-left: 5px solid #4fa3ff;
    font-family:'Noto Sans KR', sans-serif; 
    font-weight: 400;
    transition: all 0.3s ease; /* transition ì¶”ê°€í•˜ì—¬ ë¶€ë“œëŸ½ê²Œ ìˆ¨ê²¨ì§€ë„ë¡ */
}
/* ğŸ’¡ [ì¶”ê°€] ë‚´ìš©ì´ ì—†ì„ ë•Œ ì™„ì „íˆ ìˆ¨ê¹€ ì²˜ë¦¬í•˜ì—¬ UIë¥¼ ê¹”ë”í•˜ê²Œ ìœ ì§€ */
.result-box:empty {
    padding: 0;
    margin-top: 0;
    border: none;
    background: none;
    box-shadow: none;
    min-height: 0;
    line-height: 0;
}

.result-box b {color: #a0d8ff; font-weight: 700;}
</style>
</head>
<body>
<div class="nebula"></div>
<div class="nebula"></div>
<canvas id="space"></canvas>

<div class="calculator-panel">
    <div class="clock-box" id="clockDisplay"></div> 
    <div class="tab-buttons">
        <button class="active" onclick="showTab('deposit',event)">ì˜ˆê¸ˆ</button>
        <button onclick="showTab('saving',event)">ì ê¸ˆ</button>
        <button onclick="showTab('loan',event)">ëŒ€ì¶œ</button>
    </div>

    <div id="deposit" class="tab active">
        <label>ì˜ˆì¹˜ê¸ˆì•¡(ì›)</label><input type="text" inputmode="numeric" id="dep_amount" class="num amount" placeholder="ì›ê¸ˆ (ìˆ«ìë§Œ ì…ë ¥)">
        <label>ì—° ì´ììœ¨(%)</label><input type="text" inputmode="decimal" id="dep_rate" class="num rate" placeholder="ì—° ì´ììœ¨" value="1.0">
        <label>ê¸°ê°„(ê°œì›”)</label><input type="text" inputmode="numeric" id="dep_month" class="num month" placeholder="ê¸°ê°„ (ê°œì›”)" value="12">
        <label>ì´ì ë°©ì‹</label>
        <select id="dep_type">
            <option value="simple">ë‹¨ë¦¬</option>
            <option value="monthly">ì›”ë³µë¦¬</option>
            <option value="yearly">ì—°ë³µë¦¬</option>
        </select>
        <button class="calculate" onclick="calcDeposit(this)">ê³„ì‚°í•˜ê¸°</button>
        <div id="dep_result" class="result-box"></div>
    </div>

    <div id="saving" class="tab">
        <label>ì›” ë‚©ì…ì•¡(ì›)</label><input type="text" inputmode="numeric" id="sav_amount" class="num amount" placeholder="ì›” ë‚©ì…ì•¡ (ìˆ«ìë§Œ ì…ë ¥)">
        <label>ì—° ì´ììœ¨(%)</label><input type="text" inputmode="decimal" id="sav_rate" class="num rate" placeholder="ì—° ì´ììœ¨" value="1.0">
        <label>ê¸°ê°„(ê°œì›”)</label><input type="text" inputmode="numeric" id="sav_month" class="num month" placeholder="ê¸°ê°„ (ê°œì›”)" value="12">
        <label>ì´ì ë°©ì‹</label>
        <select id="sav_type">
            <option value="compound">ë³µë¦¬(ì€í–‰ì‹)</option>
            <option value="simple">ë‹¨ë¦¬</option>
        </select>
        <button class="calculate" onclick="calcSaving(this)">ê³„ì‚°í•˜ê¸°</button>
        <div id="sav_result" class="result-box"></div>
    </div>

    <div id="loan" class="tab">
        <label>ëŒ€ì¶œê¸ˆì•¡(ì›)</label><input type="text" inputmode="numeric" id="loan_amount" class="num amount" placeholder="ëŒ€ì¶œ ì›ê¸ˆ (ìˆ«ìë§Œ ì…ë ¥)">
        <label>ì—° ì´ììœ¨(%)</label><input type="text" inputmode="decimal" id="loan_rate" class="num rate" placeholder="ì—° ì´ììœ¨" value="4.0">
        <label>ê¸°ê°„(ê°œì›”)</label><input type="text" inputmode="numeric" id="loan_month" class="num month" placeholder="ê¸°ê°„ (ê°œì›”)" value="120">
        <label>ìƒí™˜ ë°©ì‹</label>
        <select id="loan_type">
            <option value="amortization">ì›ë¦¬ê¸ˆê· ë“±</option>
            <option value="principal">ì›ê¸ˆê· ë“±</option>
            <option value="bullet">ë§Œê¸°ì¼ì‹œ</option>
        </select>
        <button class="calculate" onclick="calcLoan(this)">ê³„ì‚°í•˜ê¸°</button>
        <div id="loan_result" class="result-box"></div>
    </div>
</div>

<script>
// --- JavaScript ì‹œì‘ ---

// ğŸ’¡ [ì¶”ê°€] ì´ˆê¸° ë¡œë“œ ì„¤ì • ë° ê²°ê³¼ì°½ ë¹„ìš°ê¸°
window.onload = function() {
    // ëª¨ë“  ê²°ê³¼ì°½ ì´ˆê¸°í™” (CSSì˜ :emptyê°€ ì ìš©ë˜ë„ë¡ ë¹„ì›€)
    document.getElementById('dep_result').innerHTML = '';
    document.getElementById('sav_result').innerHTML = '';
    document.getElementById('loan_result').innerHTML = '';
    updateClock(); // ì´ˆê¸° ì‹œê³„ ì—…ë°ì´íŠ¸
};

// ì‹œê³„ (ìˆ˜ì •)
function updateClock(){
    const now=new Date();
    const y=now.getFullYear(), m=String(now.getMonth()+1).padStart(2,'0'), d=String(now.getDate()).padStart(2,'0');
    const days=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];
    const wd=days[now.getDay()];
    const hh=String(now.getHours()).padStart(2,'0'), mm=String(now.getMinutes()).padStart(2,'0'), ss=String(now.getSeconds()).padStart(2,'0');
    
    // ğŸ’¡ [ìˆ˜ì •] clockDisplayì— ì‹¤ì‹œê°„ ì‹œê³„ í‘œì‹œ
    const clockDisplay = document.getElementById("clockDisplay");
    if (clockDisplay) {
        clockDisplay.textContent=`${y}-${m}-${d} (${wd}) ${hh}:${mm}:${ss}`;
    }
}
setInterval(updateClock,1000); 

// TAB (ê²°ê³¼ì°½ ì´ˆê¸°í™” ë¡œì§ ì¶”ê°€)
function showTab(id,event){
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    document.querySelectorAll(".tab-buttons button").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
    // ğŸ’¡ [ìˆ˜ì •] íƒ­ ì „í™˜ ì‹œ í•´ë‹¹ íƒ­ì˜ ê²°ê³¼ì°½ì„ ì´ˆê¸°í™”í•˜ì—¬ CSS :emptyê°€ ì ìš©ë˜ë„ë¡ ë¹„ì›€
    document.getElementById(id + '_result').innerHTML = ''; 
}

// ğŸ’¡ ì½¤ë§ˆ/ìˆ«ì ì²˜ë¦¬ í•¨ìˆ˜ (addComma, uncomma)
function addComma(num){
    const fixedNum = Number(num).toFixed(2); 
    if (fixedNum.endsWith('.00')) {
        return Number(fixedNum).toLocaleString('ko-KR', { maximumFractionDigits: 0 });
    }
    return fixedNum.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

function uncomma(str){
    return parseFloat(String(str).replace(/,/g,"").replace(/[^\d.]/g,"")) || 0;
}

// ğŸ’¡ ì‹¤ì‹œê°„ ì½¤ë§ˆ ì…ë ¥ ì²˜ë¦¬
document.querySelectorAll(".num").forEach(input => {
    input.addEventListener("input", function() {
        let raw = this.value.replace(/,/g,"");
        
        // ìˆ«ì, ì†Œìˆ˜ì ë§Œ í—ˆìš©
        if (this.classList.contains('amount') || this.classList.contains('month')) {
            // ì •ìˆ˜ ë° ê¸ˆì•¡/ê¸°ê°„
            raw = raw.replace(/[^\d]/g, "");
        } else {
            // ì´ììœ¨ (ì†Œìˆ˜ì  í—ˆìš©)
            raw = raw.replace(/[^\d.]/g, "");
            const parts = raw.split('.');
            if(parts.length > 2) raw = parts[0] + '.' + parts[1];
        }

        if(raw !== "") {
            const hasDecimal = raw.endsWith('.');
            
            if(this.classList.contains('rate')) {
                this.value = raw;
            } else {
                // ê¸ˆì•¡/ê¸°ê°„ì€ ì½¤ë§ˆ ì ìš©
                const formatted = Number(raw).toLocaleString('ko-KR', { maximumFractionDigits: 0 });
                this.value = hasDecimal ? formatted + '.' : formatted;
            }
        } else {
            this.value = "";
        }
    });

    input.addEventListener("blur", function() {
        const val = uncomma(this.value);
        if (val === 0) {
            this.value = "";
        }
        
        if (this.classList.contains('rate') && val > 100) {
            this.value = 100;
        }
    });
});


// ğŸ’¡ [2] ê³„ì‚° í›„ ì •í™•í•œ ìŠ¤í¬ë¡¤ í•¨ìˆ˜
function scrollToResult(buttonElement) {
    const parentTab = buttonElement.closest('.tab');
    const resultBox = parentTab.querySelector('.result-box');
    
    if (resultBox && resultBox.innerHTML !== '') { // ê²°ê³¼ê°€ ìˆì„ ë•Œë§Œ ìŠ¤í¬ë¡¤
        const panel = buttonElement.closest('.calculator-panel');
        if (panel) {
            // ğŸ’¡ ê²°ê³¼ ë°•ìŠ¤ ë°”ë¡œ ìœ„ë¡œ ìŠ¤í¬ë¡¤ (ê°€ì¥ ì •í™•í•œ ìœ„ì¹˜)
            panel.scrollTo({
                top: resultBox.offsetTop - 20, 
                behavior: 'smooth'
            });
        }
    }
}

// ğŸ’¡ ìœ íš¨ì„± ê²€ì‚¬ í•¨ìˆ˜ (Validation)
function validateInputs(P, r, m, resultElement) {
    if (P <= 0 || r < 0 || m <= 0 || isNaN(P) || isNaN(r) || isNaN(m)) {
        resultElement.innerHTML = `<span style="color:#ff6b6b;">â— ì˜¤ë¥˜: ëª¨ë“  ì…ë ¥ê°’ì„ 0ë³´ë‹¤ í° ìœ íš¨í•œ ìˆ«ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì´ììœ¨ì€ 0 í—ˆìš©)</span>`;
        return false;
    }
    return true;
}

// ğŸ’° ì˜ˆê¸ˆ (Deposit)
function calcDeposit(buttonElement){
    const P=uncomma(dep_amount.value);
    const annualRate=uncomma(dep_rate.value)/100;
    const m=Number(uncomma(dep_month.value));
    const type=dep_type.value;
    const resultElement = dep_result;

    if (!validateInputs(P, annualRate * 100, m, resultElement)) return;
    
    const taxRate = 0.154;
    let total=0;

    if(type==="simple") {
        total = P * (1 + annualRate * (m / 12));
    } else if(type==="monthly") {
        const monthlyRate = annualRate / 12;
        total = P * Math.pow(1 + monthlyRate, m);
    } else if(type==="yearly") {
        total = P * Math.pow(1 + annualRate, m / 12);
    }
    
    const interest=total-P;
    const tax = interest * taxRate;
    const afterTaxInterest = interest - tax;
    const afterTaxTotal = P + afterTaxInterest;

    dep_result.innerHTML=`
        ğŸ’° <b>ì˜ˆê¸ˆ ê²°ê³¼ (ì„¸í›„)</b><br>
        ì›ê¸ˆ: ${addComma(P)}ì›<br>
        ì„¸ì „ ì´ì: ${addComma(interest)}ì›<br>
        ì„¸ê¸ˆ(15.4%): ${addComma(tax)}ì›<br>
        ì„¸í›„ ì´ì: **${addComma(afterTaxInterest)}ì›**<br>
        ë§Œê¸°ìˆ˜ë ¹ì•¡: **${addComma(afterTaxTotal)}ì›**
    `;
    scrollToResult(buttonElement);
}

// ğŸ“¦ ì ê¸ˆ (Saving)
function calcSaving(buttonElement){
    const A = uncomma(sav_amount.value);
    const annualRate = uncomma(sav_rate.value)/100;
    const n = Number(uncomma(sav_month.value));
    const type = sav_type.value;
    const resultElement = sav_result;

    if (!validateInputs(A, annualRate * 100, n, resultElement)) return;
    
    const taxRate = 0.154;
    let total = 0;
    const paid = A*n;

    if(type === "compound"){ // ë³µë¦¬(ì€í–‰ì‹)
        const r = annualRate / 12;
        for(let i=1; i<=n; i++){
            const power = n - i;
            total += A * Math.pow(1 + r, power);
        }
    } else { // ë‹¨ë¦¬
        for(let i=0; i<n; i++){
            total += A * (1 + annualRate * ((n-i) / 12));
        }
    }

    const interest = total - paid;
    const tax = interest * taxRate;
    const afterTaxInterest = interest - tax;
    const afterTaxTotal = paid + afterTaxInterest;

    sav_result.innerHTML = `
        ğŸ“¦ <b>ì ê¸ˆ ê²°ê³¼ (ì„¸í›„)</b><br>
        ì´ ë‚©ì…ì•¡: ${addComma(paid)}ì›<br>
        ì„¸ì „ ì´ì: ${addComma(interest)}ì›<br>
        ì„¸ê¸ˆ(15.4%): ${addComma(tax)}ì›<br>
        ì„¸í›„ ì´ì: **${addComma(afterTaxInterest)}ì›**<br>
        ë§Œê¸°ìˆ˜ë ¹ì•¡: **${addComma(afterTaxTotal)}ì›**
    `;
    scrollToResult(buttonElement);
}

// ğŸ¦ ëŒ€ì¶œ (Loan)
function calcLoan(buttonElement){
    const L=uncomma(loan_amount.value);
    const annualRate=uncomma(loan_rate.value)/100;
    const n=Number(uncomma(loan_month.value));
    const type=loan_type.value;
    const resultElement = loan_result;

    if (!validateInputs(L, annualRate * 100, n, resultElement)) return;
    
    const r=annualRate/12;
    let monthly=0, total=0, interest=0;

    if(type==="amortization"){ // ì›ë¦¬ê¸ˆê· ë“±
        if (n === 0 || r === 0) {
            monthly = L / n; 
            interest = 0;
        } else {
            // ì›ë¦¬ê¸ˆê· ë“± ìƒí™˜ì•¡ ê³µì‹: M = P * [ i(1 + i)^n ] / [ (1 + i)^n - 1 ]
            monthly = L * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
            total=monthly*n; 
            interest=total-L;
        }
        monthly = addComma(monthly) + "ì›";
    } else if(type==="principal"){ // ì›ê¸ˆê· ë“±
        const principal=L/n;
        let intSum=0;
        for(let i=0;i<n;i++) {
            const currentInterest = (L - principal * i) * r;
            intSum += currentInterest;
        }
        interest=intSum; 
        total=L+interest;
        monthly="ë§¤ì›” ì›ê¸ˆ "+addComma(principal)+"ì› + ì´ì (ìµœì´ˆ "+addComma(principal + (L*r))+"ì›)";
    } else if(type==="bullet"){ // ë§Œê¸°ì¼ì‹œ
        interest=L*r*n; 
        total=L+interest; 
        monthly="ë§¤ì›” ì´ì "+addComma(L*r)+"ì› (ë§ˆì§€ë§‰ ë‹¬ì— ì›ê¸ˆ "+addComma(L)+"ì›)";
    }
    loan_result.innerHTML=`ğŸ¦ <b>ëŒ€ì¶œ ê²°ê³¼</b><br>
        ì›” ë‚©ì…ì•¡: ${typeof monthly==="string"?monthly:monthly}<br>
        ì´ ì´ì: ${addComma(interest)}ì›<br>
        ìµœì¢… ìƒí™˜ì•¡: **${addComma(total)}ì›**
    `;
    scrollToResult(buttonElement);
}

// ìŠ¤íƒ€í•„ë“œ (ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜) - ê¸°ì¡´ ì½”ë“œ ìœ ì§€
const canvas=document.getElementById("space"), ctx=canvas.getContext("2d"); let w,h;
function resize(){w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight;}
window.addEventListener("resize",resize); resize();
let stars=[]; let count=1000; let focal=500;
function initStars(){stars=[];for(let i=0;i<count;i++){stars.push({x:(Math.random()-0.5)*w,y:(Math.random()-0.5)*h,z:Math.random()*focal,speed:0.4+Math.random()});}}
initStars();
function animate(){ctx.clearRect(0,0,w,h);for(let s of stars){s.z-=s.speed;if(s.z<=0){s.z=focal;s.x=(Math.random()-0.5)*w;s.y=(Math.random()-0.5)*h;}let k=focal/s.z,px=s.x*k+w/2,py=s.y*k+h/2;ctx.fillStyle="rgba(255,255,255,"+(1-s.z/focal)+")";ctx.beginPath();ctx.arc(px,py,1.2+(1-s.z/focal)*2,0,Math.PI*2);ctx.fill();}requestAnimationFrame(animate);}
animate();
</script>
</body>
</html>
